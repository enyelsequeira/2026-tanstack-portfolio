# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Commands

```bash
pnpm dev          # Start dev server on port 3000
pnpm build        # Production build
pnpm preview      # Preview production build
pnpm test         # Run tests (vitest run)
pnpm lint         # Biome lint
pnpm format       # Biome format
pnpm check        # Biome check (lint + format)
pnpm deploy       # Build + deploy to Cloudflare via wrangler
```

Run a single test file:
```bash
pnpm vitest run src/path/to/file.test.tsx
```

## Architecture

**Stack**: TanStack Start (SSR) + React 19 + Vite 7, deployed on Cloudflare Workers.

### Routing

File-based routing via TanStack Router. Routes live in `src/routes/`. The route tree is **auto-generated** into `src/routeTree.gen.ts` — never edit this file manually. Each route file exports a `Route` constant created with `createFileRoute`.

The root route (`src/routes/__root.tsx`) uses `shellComponent` (not `component`) to define the full HTML shell. It wraps the app with `MantineProvider` and `ConvexProvider`.

The router is instantiated in `src/router.tsx` via `getRouter()` and registered with module augmentation for type safety.

### Data Layer (Convex)

Convex backend functions live in `convex/` — queries and mutations exported from files like `convex/todos.ts`. Schema is defined in `convex/schema.ts`.

The `convex/_generated/` directory is auto-generated by the Convex CLI — do not edit. Import the API using `import { api } from "../../convex/_generated/api"`.

The Convex React provider is at `src/integrations/convex/provider.tsx` and requires `VITE_CONVEX_URL` in the environment.

### UI

Mantine v8 is the component library. The custom theme (brand colors, primary color) is defined inline in `__root.tsx`. PostCSS is configured in `postcss.config.cjs` with `postcss-preset-mantine` breakpoints. Tailwind utility classes are also used alongside Mantine components.

### Environment Variables

Validated via `@t3-oss/env-core` + Zod in `src/env.ts`. Client-side vars must be prefixed with `VITE_`. Runtime env comes from `import.meta.env`. Required env: `VITE_CONVEX_URL`.

### Path Aliases

- `@/*` → `src/*` (tsconfig paths)
- `#/*` → `src/*` (package.json imports field)

## Code Style

Biome is the linter/formatter. Key settings:
- **Indentation**: tabs
- **Quotes**: double quotes for JS/TS strings
- Biome scopes to `src/**/*` and `vite.config.ts`; ignores `src/routeTree.gen.ts` and `src/styles.css`

TypeScript is in strict mode with `noUnusedLocals` and `noUnusedParameters` enabled.
